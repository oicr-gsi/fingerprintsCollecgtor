## Commands
This section lists command(s) run by hotspotFingerprintsCollector workflow

* Running hotspotFingerprintsCollector

=== Commands for downsampling, markDuplicates and generateFingerprint ===.

<<<
 set -euo pipefail
 
 seqtk sample -s 100 ~{fastqR1} ~{maxReads} > ~{fastqR1m}
 gzip ~{fastqR1m}
 
 seqtk sample -s 100 ~{fastqR2} ~{maxReads} > ~{fastqR2m}
 gzip ~{fastqR2m}
>>>
<<<
  set -euo pipefail
  $GATK_ROOT/bin/gatk --java-options "-Xmx~{jobMemory - overhead}G" MarkDuplicates \
                      -I ~{inputBam} \
                      --METRICS_FILE ~{outputFileNamePrefix}.dupmetrics \
                      --VALIDATION_STRINGENCY SILENT \
                      --CREATE_INDEX true \
                      -O ~{outputFileNamePrefix}.dupmarked.bam
>>>
<<<
  set -euo pipefail
  $SAMTOOLS_ROOT/bin/samtools coverage ~{inputBam} > ~{outputFileNamePrefix}.coverage.txt
  cat ~{outputFileNamePrefix}.coverage.txt | grep -P "^chr\d+\t|^chrX\t|^chrY\t" | awk '{ space += ($3-$2)+1; bases += $7*($3-$2);} END { print bases/space }' | awk '{print "{\"mean coverage\":" $1 "}"}' > ~{outputFileNamePrefix}.json
>>>
<<<
 set -euo pipefail
 $GATK_ROOT/bin/gatk HaplotypeCaller \
                    -R ~{refFasta} \
                    -I ~{inputBam} \
                    -O ~{outputFileNamePrefix}.hotspots.vcf \
                    --read-filter CigarContainsNoNOperator \
                   --stand-call-conf ~{stdCC} \
                    -L ~{hotspots}

 $TABIX_ROOT/bin/bgzip -c ~{outputFileNamePrefix}.hotspots.vcf > ~{outputFileNamePrefix}.hotspots.vcf.gz
 $TABIX_ROOT/bin/tabix -p vcf ~{outputFileNamePrefix}.hotspots.vcf.gz 
 
 $GATK_ROOT/bin/gatk DepthOfCoverage \
                     -R ~{refFasta} \
                     -I ~{inputBam} \
                     -O ~{outputFileNamePrefix} \
                     --read-filter CigarContainsNoNOperator \
                     -L ~{hotspots} 
 
>>>
